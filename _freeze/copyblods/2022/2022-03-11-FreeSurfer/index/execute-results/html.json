{
  "hash": "5a1e48ee120092f999662f4e608c36df",
  "result": {
    "markdown": "---\ntitle: FreeSurfer笔记之一\nauthor: 桑峰\ndate: 2022-03-11\nslug: blog\noutput: html_document\ncategories:\n  - FreeSurfer\ntags:\n  - freesurfer\n  - surface\n  - t1w\n---\n\n\n## Outputs\n\nFreeSurfer首先去除颅骨（stripped skull），生成brainmask.mgz文件，并进一步分出灰质、白质和皮下结构，保存在aseg.mgz文件中。与此同时，得到白质/灰质的初步估计（?h.orig），随后对分界面进行进一步的调整得到?j.white。在?h.white的基础上，分界面继续向外膨胀得到?h.pial，并进一步膨胀得到?h.inflated。?h.sphere为?h.inflated膨胀形成的球面。可以用来与其他空间图像进行配准（例如fsaverage）。\n\n\nrecon-all命令中的-qcache可以生成fsaverage空间中的且经过平滑后的数据。\n\n### label文件夹\n\n.ctab文件为颜色表（color table），存储不同atlas定义脑区的颜色。.annot文件为分区信息，其中包含每个vertex所属的脑区等信息。.label文件保存所有vertex所属脑区编号和坐标。\n\n### surf文件夹\n?h.area为midthickness表面的面积，?h.area.pial为灰质（软脑膜）表面的面积。?h.sulc为沟回宽度。\n\n### stats文件夹\n\n保存不同分区下的灰质指标。\n\n## 命令\n\n### mris_preproc\n\n将个体皮层空间中的指标文件投射到fsavergae等标准皮层空间。\n\n\n#### Example-1\n\nResample abcXX-anat/surf/lh.thickness onto fsaverage:\n\n```bash\nmris_preproc --s abc01-anat \\\n             --s abc02-anat \\\n             --s abc03-anat \\\n             --s abc04-anat \\\n             --target fsaverage \\\n             --hemi lh \\\n             --meas thickness \\\n             --out abc-lh-thickness.mgh\n```\n\n#### Example-2\n\nSame as #1 but smooths by 5mm fwhm:\n\n```bash\nmris_preproc --s abc01-anat \\\n             --s abc02-anat \\\n             --s abc03-anat \\\n             --s abc04-anat \\\n             --target fsaverage \\\n             --hemi lh \\\n             --meas thickness \\ \n             --fwhm 5 \\\n             --out abc-lh-thickness.sm5.mgh\n```\n\n### mri_glmfit\n\nGLM建模统计。\n\n### mri_glmfit-sim\n\n多重比较校正。\n\n### mri_vol2vol / mri_vol2surf / mri_surf2surf\n\n体素/皮层空间到体素/皮层空间的投射。\n\n#### Example-1\n\n将fsaverage空间中的prcellation文件（aaa.annot）转换到个体皮层空间（bbb.annot）。\n\n```bash\nmri_surf2surf --hemi lh \\\n  --srcsubject fsaverage \\\n  --sval-annot aaa.annot \\\n  --trgsubject sub-xxx \\\n  --trgsurfval bbb.annot\n```\n\n### mris_calc\n\n类似fslmath，对图像进行计算。\n\n\n### fs皮层空间到MNI体素空间\n\n首先需要对一个标准空间中的图像进行recon-all处理，这里以ch2.nii.gz为例。（参考B站up[\\@七彩神经](https://space.bilibili.com/567290402/?spm_id_from=333.999.0.0)）\n\n```bash\n\nrecon-all -s ch2 -i ch2.nii.gz -all\n\n# 将fsaverage空间中的label文件转换到个体的皮层空间\nmri_label2label --srclabel xxx \\\n                --srcsubject fsaverage \\\n                --trgsubject ch2 \\\n                --trglabel xxx \\\n                --regmethod surface \\\n                --hemi xxx\n\n# 生成个体体素空间到皮层空间的映射关系\ntkregister2 --mov xxx/ch2/mri/orig.mgz \\\n            --noedit \\\n            --s ch2 \\\n            --regheader \\\n            --reg register.dat\n\n# 将个体皮层空间中的label转换为体素空间中的.nii文件\nmri_label2vol --label xxx \\\n              --temp xxx/ch2/mri/orig.mgz \\\n              --subject ch2 \\\n              --hemi xxx \\\n              --o xxx \\\n              --proj frac 0.1 0.1 \\\n              --fillthresh 0.5 \\\n              --reg register.dat\n```\n\n## 参考\n\n[1]: [FreeSurferWiki](https://surfer.nmr.mgh.harvard.edu/fswiki/FreeSurferWiki)\n\n[2]: [Andy's Brain Book](https://andysbrainbook.readthedocs.io/en/latest/)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}